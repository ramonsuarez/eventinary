<% cloudinary_path = "http://res.cloudinary.com/serendipity/image/upload/" %>

<section class="users-page">
  <div class="container">

    <% if @user.avatar != nil %>
      <div class="row">
        <div class="col-xs-12 col-md-6 col-md-offset-3">
          <div class="avatar" style="background-image: linear-gradient(-225deg, rgba(0,101,168,0.6) 0%, rgba(0,36,61,0.6) 50%), url('<%= cloudinary_path + @user.avatar.path %>');"></div>
        </div>
      </div>
    <% end %>

    <div class="row">
      <div class="col-xs-12 text-center">
        <h3 style="color:#00b1b1;"><%= "#{@user.first_name} #{@user.last_name}" %></h3>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-1 col-md-offset-2 text-right">
        <h4><i class="fa fa-envelope" aria-hidden="true"></i></h4>
      </div>
      <div class="col-xs-11 col-md-6">
        <h4><%= @user.email %></h4>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-1 col-md-offset-2 text-right">
        <h4><i class="fa fa-map-marker" aria-hidden="true"></i></h4>
      </div>
      <div class="col-xs-11 col-md-6">
        <h4><%= @user.address %></h4>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-1 col-md-offset-2 text-right">
        <h4><i class="fa fa-phone" aria-hidden="true"></i></h4>
      </div>
      <div class="col-xs-11 col-md-6">
        <h4><%= @user.phone %></h4>
      </div>
    </div>

    <div id="event_tabs" class="container" style="margin-top: 50px;">
      <ul class="nav nav-tabs text-center" style="justify-content: center;">
        <li style="width:33%;"><a href="#past_events" data-toggle="tab">Past Events</a></li>
        <li style="width:33%;" class="active"><a href="#created_events" data-toggle="tab">Created Events</a></li>
        <li style="width:33%;"><a href="#upcoming_events" data-toggle="tab">Upcoming Events</a></li>
      </ul>

        <div class="tab-content">
          <div class="tab-pane active" id="created_events">

            <% current_user.organizations.each do |organization| %>

              <% if organization.events.nil? %>

                Nothing here!

              <% else %>

                <% organization.events.each do |event| %>
                  <%= link_to event do %>
                    <%= render "users/event", event: event %>
                  <% end %>
                <% end %>

              <% end %>

            <% end %>

          </div>
          <div class="tab-pane" id="upcoming_events">
            <% if @events_booked.nil? %>

              Nothing here!

            <% else %>

              <% @events_booked.each do |event| %>
                <% if event.end > Time.now %>
                  <div class="row">
                    <div class="col-xs-12">
                      <%= link_to event do %>
                        <%= render "users/event", event: event %>
                      <% end %>
                    </div>
                  </div>
                <% end %>
              <% end %>

            <% end %>

          </div>
          <div class="tab-pane" id="past_events">
            <% if @events_booked.nil? %>

              Nothing here!

            <% else %>

            <% @events_booked.each do |event| %>
                <% if event.end < Time.now %>
                <div class="row">
                  <div class="col-xs-12">
                    <%= link_to event do %>
                      <%= render "users/event", event: event %>
                    <% end %>
                  </div>
                </div>
              <% end %>
            <% end %>

          <% end %>

          </div>
        </div>
    </div>
  </div>
</section>
